on:
  push:
    branches:
      - "main"

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Clone taskfile
        run: ./task clone-taskfile
      - name: Load version 18.0
        run: ./task load-version 18.0
      - name: Clone git folder odoo
        run: ./task clone-git-folder odoo
      - name: Checkout latest revision
        run: ./task checkout-latest-revision
      - name: Login docker
        run: ./task container-login ${{ secrets.CONTAINER_REGISTRY_USERNAME }} ${{ secrets.CONTAINER_REGISTRY_PASSWORD }}
      - name: Build
        run: ./task build
