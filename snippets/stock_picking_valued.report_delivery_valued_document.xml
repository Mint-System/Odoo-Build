<t t-name="stock_picking_valued.report_delivery_valued_document">
    <t t-call="web.html_container">
        <t t-call="web.external_layout">
            <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>
            <t t-set="partner" t-value="o.partner_id or (o.move_ids and o.ids[0].partner_id) or False"/>

            <div class="row text-900 o_bold">
                <div class="col-7">Invoice Adress</div>
                <div class="col-5">Customer</div>
            </div>
            <div class="row">
                <div class="col-7">
                    <span t-field="o.x_invoice_id.commercial_company_name"/>
                </div>
                <div class="col-5">
                    <span t-field="o.x_customer_id.commercial_company_name"/>
                </div>
            </div>
            <div class="row">
                <div class="col-7">
                    <span t-field="o.x_invoice_id" t-options-widget="&quot;contact&quot;" t-options-fields="['address']" t-options-no_marker="True"/>
                </div>
                <div class="col-5">
                    <span t-field="o.x_customer_id" t-options-widget="&quot;contact&quot;" t-options-fields="['address']" t-options-no_marker="True"/>
                </div>
            </div>
            <div class="row">
                <div class="col-5 text-900 o_bold offset-7" style="margin-top:25px">Delivery Address</div>
            </div>
            <div class="row">
                <div class="col-5 offset-7">
                    <span t-field="o.partner_id.commercial_company_name"/>
                </div>
            </div>
            <div class="row">
                <div class="col-5 offset-7">
                    <span t-field="o.partner_id" t-options-widget="&quot;contact&quot;" t-options-fields="['address']" t-options-no_marker="True"/>
                </div>
            </div>
            <div class="row o_bold text-900" style="margin-top:25px">
                <div class="col-7">Your Contact</div>
                <div class="col-5">Our Contact</div>
            </div>
            <div class="row">
                <div class="col-7">
                    <span t-field="o.x_customer_id.name"/>
                </div>
                <div class="col-5">
                    <span t-field="o.user_id.name"/>
                </div>
            </div>
            <div class="row">
                <div class="col-7" style="margin-bottom:25px">
                    <span t-field="o.x_customer_id" t-options-widget="&quot;contact&quot;" t-options-fields="['phone', 'email']" t-options-no_marker="True"/>
                </div>
                <div class="col-5">
                    <span t-field="o.user_id" t-options-widget="&quot;contact&quot;" t-options-fields="['phone', 'email']" t-options-no_marker="True"/>
                </div>
            </div>


            <t t-set="information_block">
                <div class="row">
                    <div class="col-7" name="div_incoming_address">
                        <div t-if="o.picking_type_id.code=='incoming' and partner">
                            <span>
                                <strong>Vendor Address:</strong>
                            </span>
                        </div>
                        <div t-if="o.picking_type_id.code=='internal' and partner">
                            <span>
                                <strong>Warehouse Address:</strong>
                            </span>
                        </div>
                        <div t-if="o.picking_type_id.code=='outgoing' and partner">
                            <span>
                                <strong>Customer Address:</strong>
                            </span>
                        </div>
                        <div t-if="partner" name="partner_header">
                            <div t-field="partner.commercial_partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                            <p t-if="partner.sudo().commercial_partner_id.vat">
                                <t t-esc="o.company_id.country_id.vat_label or 'Tax ID'"/>
:                                <span t-field="partner.sudo().commercial_partner_id.vat"/>
                            </p>
                        </div>
                    </div>
                </div>
            </t>

            <div class="page">
                <h2>
                    <span>Invoice </span>
                    <span t-field="o.origin"/>
                    <span>-</span>
                    <span t-esc="o.name[-5:]"/>
                </h2>
                <div class="row mt32 mb32">
                    <div class="col-3" style="margin-bottom: 10px">
                        <strong>Invoice Date:</strong>
                        <p t-field="o.date_done" t-options="{&quot;widget&quot;: &quot;date&quot;}"/>
                    </div>
                    <div class="col-3">
                        <strong>Reference:</strong>
                        <p t-field="o.sudo().sale_id.client_order_ref"/>
                    </div>
                    <div class="col-3">
                        <strong>Incoterm:</strong>
                        <p t-field="o.sudo().sale_id.incoterm.code"/>
                    </div>
                    <div class="col-3">
                        <strong>Weight:</strong>
                        <br/>
                        <span t-field="o.shipping_weight"/>
                        <span t-field="o.weight_uom_name"/>
                    </div>
                </div>

                <table class="table table-sm" name="stock_move_table">
                    <!-- Is there a discount on at least one line? -->
                    <t t-set="display_discount" t-value="any([l.discount for l in o.move_ids])"/>
                    <thead>
                        <tr>
                            <th name="th_description" class="text-left">
                                <strong>Product</strong>
                            </th>
                            <th name="th_quantity" class="text-right">
                                <strong>Quantity</strong>
                                <br/>
                                <i>Weight</i>
                            </th>
                            <th class="text-right">Origin</th>
                            <th name="th_priceunit" class="text-right">
                                <strong>Unit Price</strong>
                            </th>
                            <th name="th_discount" t-if="display_discount" class="text-right" groups="product.group_discount_per_so_line">
                                <strong>
                                    <span>Disc.%</span>
                                </strong>
                            </th>
                            <th name="th_taxes" class="text-right">
                                <strong>Taxes</strong>
                            </th>
                            <th name="th_subtotal" class="text-right">
                                <t groups="account.group_show_line_subtotals_tax_excluded">
                                    <strong>Amount</strong>
                                </t>
                                <t groups="account.group_show_line_subtotals_tax_included">
                                    <strong>Total Price</strong>
                                </t>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="lines" t-value="o.move_ids.filtered(lambda x: x.product_uom_qty)"/>
                        <tr t-foreach="lines" t-as="move">
                            <td name="td_description" class="text-left">
                                <span t-field="move.product_id"/>
                                <p t-if="o.picking_type_code == 'outgoing'">
                                    <span t-field="move.product_id.sudo().description_pickingout"/>
                                </p>
                                <p t-if="o.picking_type_code == 'incoming'">
                                    <span t-field="move.product_id.sudo().description_pickingin"/>
                                </p>
                            </td>
                            <td name="td_quantity" class="text-right">
                                <span t-field="move.product_uom_qty"/>
                                <span t-field="move.product_uom"/>
                                <br/>
                                <i>
                                    <span t-field="move.product_id.weight"/>
                                    <span t-field="move.product_id.weight_uom_name"/>
                                </i>
                            </td>
                            <td class="text-right">
                                <span t-field="move.product_id.intrastat_origin_country_id"/>
                            </td>

                            <!-- kgi
                                <td name="td_priceunit" class="text-right">
                                    <span t-field="move.move_price_unit"/>
                                </td>
                                -->

                            <td name="td_discount" t-if="display_discount" class="text-right" groups="product.group_discount_per_so_line">
                                <span t-field="move.discount"/>
                            </td>
                            <td name="td_taxes" class="text-right">
                                <span t-esc="', '.join(map(lambda x: (x.description or x.name), move.tax_id))"/>
                            </td>
                            <td name="td_subtotal" class="text-right o_price_total">
                                <span t-field="move.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                <span t-field="move.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                            </td>
                        </tr>
                    </tbody>
                </table>


                <div>
                    <div id="right-elements" t-attf-class="#{'col-5' if report_type != 'html' else 'col-12 col-md-5'} ms-5 d-inline-block float-end">
                        <div id="total" class="clearfix row">
                            <div class="ms-auto">
                                <table class="table table-sm table-borderless avoid-page-break-inside">

                                    <!--Tax totals-->
                                    <t t-set="tax_totals" t-value="o.tax_totals or {}"/>
                                    <t t-call="account.document_tax_totals"/>

                                    <!--Payments-->
                                    <t t-if="print_with_payments">
                                        <t t-if="o.payment_state != 'invoicing_legacy'">
                                            <t t-set="payments_vals" t-value="o.sudo().invoice_payments_widget and o.sudo().invoice_payments_widget['content'] or []"/>
                                            <t t-foreach="payments_vals" t-as="payment_vals">
                                                <tr t-if="payment_vals['is_exchange'] == 0">
                                                    <td>
                                                        <i class="oe_form_field text-end oe_payment_label">Paid on <t t-out="payment_vals['date']" t-options="{&quot;widget&quot;: &quot;date&quot;}">2021-09-19</t>
                                                        </i>
                                                    </td>
                                                    <td class="text-end">
                                                        <span t-out="payment_vals['amount']" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}">20.00</span>
                                                    </td>
                                                </tr>
                                            </t>
                                            <t t-if="len(payments_vals) &gt; 0">
                                                <tr class="border-black fw-bold">
                                                    <td>Amount Due</td>
                                                    <td class="text-end">
                                                        <span t-field="o.amount_residual">11.05</span>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </t>
                                </table>
                            </div>
                        </div>
                        <div class="mb-2">
                            <p class="text-end lh-sm" t-if="o.company_id.display_invoice_amount_total_words">
                                        Total amount in words: <br/>
                            <small class="text-muted lh-sm">
                                <span t-field="o.amount_total_words">Thirty one dollar and Five cents</span>
                            </small>
                        </p>
                    </div>
                    <t t-call="account.document_tax_totals_company_currency_template"/>
                </div>



                <p t-field="o.note"/>
                <span t-field="o.sale_id.note"/>

                <!-- kgi
                    <p t-if="o.payment_term_id.note">
                        <span t-field="o.payment_term_id.note"/>
                    </p>
                    -->

                <!--  kgi
                    <p id="fiscal_position_remark" t-if="o.fiscal_position_id and o.fiscal_position_id.sudo().note">
                        <strong>Fiscal Position Remark:</strong>
                        <span t-field="o.fiscal_position_id.sudo().note"/>
                    </p>
                    -->

                <div t-if="o.signature" class="mt32 ml64 mr4" name="signature">
                    <div class="offset-8">
                        <strong>Signature</strong>
                    </div>
                    <div class="offset-8">
                        <img t-att-src="image_data_uri(o.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                    </div>
                    <div class="offset-8 text-center">
                        <p t-field="o.partner_id.name"/>
                    </div>
                </div>

                <div class="oe_structure"/>

            </div>
        </t>
    </t>
</t>