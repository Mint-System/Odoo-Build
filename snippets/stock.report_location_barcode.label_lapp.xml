<data inherit_id="stock.report_location_barcode" priority="50">
    <xpath expr="//t[@t-call='stock.report_generic_barcode']" position="replace">

        <style>
        .container {
            padding-top: 0px !important;
            padding-right: 0px !important;
            padding-left: 0px !important;
            margin: 0px !important;
        }
        </style>

        <t t-foreach="docs" t-as="o">
            <t t-set="title">Locations</t>
            <t t-name="stock.report_generic_barcode">
                <t t-call="web.basic_layout">
                    <t t-call="web.html_container">
                        <div>
                            <table style="width: 100%; background-color: white; border-color: white">
                                <!-- Section 1: Logo -->
                                <tr>
                                    <td>
                                        <div class="text-center">
                                            <span>
                                                <!-- URL according to attachment id -->
                                                <img t-att-src="'/web/image/673'" style="height: 5mm; margin-top: 10px" alt="Logo"/>
                                            </span>
                                        </div>
                                    </td>
                                </tr>
                                <!-- Section 2: name (font-size in relation to text length) -->                               
                                <tr>
                                    <td style="background-color: white">                                        
                                        <t t-set="name_text" t-value="o.name or ''"/>
                                        <t t-set="name_len" t-value="len(name_text) if name_text else 1"/>                                       
                                        <t t-set="max_font_size" t-value="int(30 * 3.78)"/>
                                        <t t-set="font_size" t-value="min(min(140, max(20, int(450 / name_len * 2))), max_font_size)"/>
                                        <t t-set="line_height" t-value="int(font_size * 1.1)"/> 
                                        <!-- Fix height at 38 mm -->                                    
                                        <div style="margin:0 auto; min-height:38mm; max-height:38mm; height:38mm; text-align:center; overflow:hidden;">
                                            <table style="width:100%; height:100%; border-collapse:collapse;">
                                                <tr>
                                                    <td style="vertical-align:middle; text-align:center;">
                                                        <span t-out="o.name"
                                                              t-att-style="'display:inline-block; white-space:nowrap; overflow:hidden; font-size:{}px; line-height:{}px;'.format(font_size, line_height)">
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </td>
                                </tr> 

                                <!-- Show variables for debugging -->
                                <!-- 
                                <tr>
                                    <td>
                                        <div class="text-center">
                                            Schriftgröße: <t t-esc="font_size"/> px /
                                            Zeilenhöhe: <t t-esc="line_height"/> px /                                           
                                        </div>
                                    </td>
                                </tr>
                                -->                                
                                <!-- Section 3: Barcode --> 
                                <tr>
                                    <td>
                                        <div class="text-center">
                                            <span t-if="o.barcode" t-field="o.barcode" style="margin-bottom: 0px;"
                                                  t-options="{'widget': 'barcode', 'humanreadable': 0, 'symbology': 'auto', 
                                                              'img_style': 'width:50mm;height:10mm; margin-bottom: 10px'}">1234567890</span>
                                        </div>
                                    </td>
                                </tr>                              
                                
                            </table>
                        </div>
                    </t>
                </t>
            </t>
        </t>
    </xpath>
</data>
